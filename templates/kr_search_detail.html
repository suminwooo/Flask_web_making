{% extends 'base.html' %}

{% block main %}

    <div class="search_container">

        <div class="search_container1">
            <h1>{{STOCK['kr_stock_name']}} / {{STOCK['kr_stock_code']}} / {{STOCK['kr_ind_name']}}</h1>
            <table>
                <tr>
                <td>코스피</td>
                    <td>{{main_page_value['kospi_individual']}}</td>
                    <td>{{main_page_value['kospi_foreigner']}}</td>
                    <th>{{main_page_value['kospi_Institutional']}}</th>
                </tr>
                <tr>
                <td>코스닥</td>
                    <td>{{main_page_value['kosdaq_individual']}}</td>
                    <td>{{main_page_value['kosdaq_foreigner']}}</td>
                    <th>{{main_page_value['kosdaq_Institutional']}}</th>
                </tr>
            </table>
        </div>

        <div class="search_container2">
            <h2>예측 정보 + 기관/외국인 현황</h2>
        </div>

        <div class="search_container3">
            <!-- TradingView Widget BEGIN -->
            <div class="tradingview-widget-container">
            <div id="tradingview_9d8b8"></div>
            <div class="tradingview-widget-copyright">TradingView 제공 <a href="https://kr.tradingview.com/symbols/KRX-005930/" rel="noopener" target="_blank"><span class="blue-text">005930 차트</span></a></div>
            <script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script>
            <script type="text/javascript">
                new TradingView.widget(
                {
                "autosize": true,
                "symbol": "KRX:005930",
                "interval": "D",
                "timezone": "Asia/Seoul",
                "theme": "light",
                "style": "1",
                "locale": "kr",
                "toolbar_bg": "#f1f3f6",
                "enable_publishing": false,
                "allow_symbol_change": true,
                "container_id": "tradingview_9d8b8"
                }
                );
            </script>
            </div>
            <!-- TradingView Widget END -->
        </div>

        <div class="search_container4">
            <h4>기본 정보(가격&거래량)</h4>
            <table>
                <thead>
                  <tr>
                    <th></th><th>가격</th><th>전일대비</th><th>등락률</th>
                  </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>종가</td>
                        <td>{{price_data['kr_stock_close']}}</td>
                        <td>{{price_diff[6]}}</td>
                        <td>{{price_diff[7]}}</td>
                    </tr>
                    <tr>
                        <td>시가</td>
                        <td>{{price_data['kr_stock_open']}}</td>
                        <td>{{price_diff[0]}}</td>
                        <td>{{price_diff[1]}}</td>
                    </tr>
                    <tr>
                        <td>고가</td>
                        <td>{{price_data['kr_stock_high']}}</td>
                        <td>{{price_diff[2]}}</td>
                        <td>{{price_diff[3]}}</td>
                    </tr>
                    <tr>
                        <td>저가</td>
                        <td>{{price_data['kr_stock_low']}}</td>
                        <td>{{price_diff[4]}}</td>
                        <td>{{price_diff[5]}}</td>
                    </tr>
                    <tr>
                        <td>거래량</td>
                        <td>{{price_data['kr_stock_volume']}}</td>
                        <td>{{price_diff[8]}}</td>
                        <td>{{price_diff[9]}}</td>
                    </tr>
                    <tr>
                        <td>52주최고가</td>
                        <td>{{nonprice_data['kr_stock_high_52week']}}</td>
                        <td>52주최저가</td>
                        <td>{{nonprice_data['kr_stock_low_52week']}}</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="search_container5">
            <h4>네이버 뉴스</h4>
            <ul>
                {% for name  in news_data %}
                <a href="{{name}}">
                <li> {{news_data[name]}} </li></a>
                {% endfor %}
            </ul>
        </div>

        <div class="search_container6">
            <h4>재무 정보</h4>
            <table>
                <tbody>
                    <tr>
                        <td>시가총액</td><td>{{nonprice_data['kr_stock_market_value']}}</td>
                        <td>코스피 순위</td><td>{{nonprice_data['kr_stock_kospi_rank']}}</td>
                    </tr>
                    <tr>
                        <td>PER</td><td>{{nonprice_data['kr_stock_PER']}}</td>
                        <td>EPS</td><td>{{nonprice_data['kr_stock_EPS']}}</td>
                    </tr>
                    <tr>
                        <td>추정 PER</td><td>{{nonprice_data['kr_stock_est_PER']}}</td>
                        <td>추정 EPS</td><td>{{nonprice_data['kr_stock_est_EPS']}}</td>
                    </tr>
                    <tr>
                        <td>PBR</td><td>{{nonprice_data['kr_stock_PBR']}}</td>
                        <td>BPS</td><td>{{nonprice_data['kr_stock_BPS']}}</td>
                    </tr>
                    <tr>
                        <td>배당율</td><td>{{nonprice_data['kr_stock_DIV']}}</td>
                        <td>코멘트</td><td>{{nonprice_data['kr_stock_comment']}}</td>
                    </tr>
                    <tr>
                        <td>동일업종 PER</td><td>{{nonprice_data['kr_stock_same_ind_per']}}</td>
                        <td>PER비율</td><td>{{nonprice_data['kr_stock_same_ind_per_percentage']}}</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="search_container7">
            <h4>과거 OHLC</h4>
            <table>
                <tr>
                    <th>날짜</th>
                    <th>시가</th>
                    <th>고가</th>
                    <th>저가</th>
                    <th>종가</th>
                </tr>
                {% for detail in all_price_data.values() %}
                <tr>
                    <td>{{ detail['DATE'] }}</td>
                    <td>{{ detail['kr_stock_open'] }}</td>
                    <td>{{ detail['kr_stock_high'] }}</td>
                    <td>{{ detail['kr_stock_low'] }}</td>
                    <td>{{ detail['kr_stock_close'] }}</td>
                </tr>
                {% endfor %}
            </table>
        </div>

    </div>
{% endblock %}

